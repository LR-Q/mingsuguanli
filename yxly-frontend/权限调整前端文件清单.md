# å‰ç«¯æƒé™è°ƒæ•´æ–‡ä»¶æ¸…å•

## âœ… å·²åˆ›å»ºçš„æ–‡ä»¶

### 1. API æ¥å£æ–‡ä»¶

#### `/src/api/modules/superAdmin.js` (å·²æ›´æ–°)
æ·»åŠ äº†ä»¥ä¸‹æ¥å£ï¼š
```javascript
- getRechargeRecords()      // è·å–å……å€¼è®°å½•
- getRechargeDetail()       // è·å–å……å€¼è¯¦æƒ…
- auditRecharge()           // å®¡æ ¸å……å€¼
- getWithdrawRecords()      // è·å–æç°è®°å½•
- getWithdrawDetail()       // è·å–æç°è¯¦æƒ…
- auditWithdraw()           // å®¡æ ¸æç°
```

#### `/src/api/modules/merchantWithdraw.js` (æ–°å»º)
```javascript
- getMyWithdrawRecords()    // æŸ¥è¯¢è‡ªå·±çš„æç°è®°å½•
- applyWithdraw()           // ç”³è¯·æç°
- cancelWithdraw()          // å–æ¶ˆæç°ç”³è¯·
- getWithdrawDetail()       // è·å–æç°è¯¦æƒ…
```

### 2. è¶…çº§ç®¡ç†å‘˜é¡µé¢

#### `/src/pages/super-admin/RechargeManagement.vue` (æ–°å»º)
- æŸ¥çœ‹æ‰€æœ‰å•†æˆ·çš„å……å€¼è®°å½•
- å®¡æ ¸å……å€¼ç”³è¯·
- APIè·¯ç”±: `/v1/super-admin/recharge`

#### `/src/pages/super-admin/WithdrawManagement.vue` (æ–°å»º)
- æŸ¥çœ‹æ‰€æœ‰å•†æˆ·çš„æç°è®°å½•
- å®¡æ ¸æç°ç”³è¯·
- APIè·¯ç”±: `/v1/super-admin/withdraw`

### 3. æ°‘å®¿ä¸»é¡µé¢

#### `/src/pages/merchant/WithdrawApply.vue` (æ–°å»º)
- ç”³è¯·æç°
- æŸ¥çœ‹è‡ªå·±çš„æç°è®°å½•
- å–æ¶ˆå¾…å®¡æ ¸çš„æç°ç”³è¯·
- APIè·¯ç”±: `/v1/merchant/withdraw`

## âš ï¸ éœ€è¦æ‰‹åŠ¨æ“ä½œçš„äº‹é¡¹

### 1. å¤„ç†æ—§æ–‡ä»¶

#### é€‰é¡¹ A: åˆ é™¤æ—§æ–‡ä»¶ï¼ˆæ¨èï¼‰
```bash
# åˆ é™¤æ°‘å®¿ä¸»ç«¯çš„å……å€¼å’Œæç°ç®¡ç†é¡µé¢
rm src/pages/admin/RechargeManagement.vue
rm src/pages/admin/WithdrawManagement.vue
```

#### é€‰é¡¹ B: ä¿ç•™ä½œä¸ºå¤‡ä»½
```bash
# é‡å‘½åæ—§æ–‡ä»¶
mv src/pages/admin/RechargeManagement.vue src/pages/admin/RechargeManagement.vue.backup
mv src/pages/admin/WithdrawManagement.vue src/pages/admin/WithdrawManagement.vue.backup
```

### 2. æ›´æ–°è·¯ç”±é…ç½®

æ‰¾åˆ°è·¯ç”±é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `src/router/index.js` æˆ– `src/router/modules/`ï¼‰

#### æ·»åŠ è¶…çº§ç®¡ç†å‘˜è·¯ç”±

```javascript
// è¶…çº§ç®¡ç†å‘˜è·¯ç”±
{
  path: '/super-admin',
  component: Layout,
  meta: { 
    requiresAuth: true, 
    requiresSuperAdmin: true 
  },
  children: [
    {
      path: 'merchant-audit',
      name: 'MerchantAudit',
      component: () => import('@/pages/super-admin/MerchantAudit.vue'),
      meta: { title: 'å•†æˆ·å®¡æ ¸ç®¡ç†' }
    },
    {
      path: 'recharge',
      name: 'SuperAdminRecharge',
      component: () => import('@/pages/super-admin/RechargeManagement.vue'),
      meta: { title: 'å……å€¼ç®¡ç†' }
    },
    {
      path: 'withdraw',
      name: 'SuperAdminWithdraw',
      component: () => import('@/pages/super-admin/WithdrawManagement.vue'),
      meta: { title: 'æç°ç®¡ç†' }
    }
  ]
}
```

#### ä¿®æ”¹æ°‘å®¿ä¸»è·¯ç”±

```javascript
// æ°‘å®¿ä¸»è·¯ç”±
{
  path: '/merchant',
  component: Layout,
  meta: { 
    requiresAuth: true, 
    requiresMerchant: true 
  },
  children: [
    // ... å…¶ä»–è·¯ç”±
    {
      path: 'withdraw-apply',
      name: 'WithdrawApply',
      component: () => import('@/pages/merchant/WithdrawApply.vue'),
      meta: { title: 'æç°ç”³è¯·' }
    }
    // ç§»é™¤æˆ–æ³¨é‡Šæ‰æ—§çš„å……å€¼ã€æç°è·¯ç”±
  ]
}
```

#### ç§»é™¤æ°‘å®¿ä¸»çš„æ—§è·¯ç”±ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

```javascript
// åˆ é™¤æˆ–æ³¨é‡Šè¿™äº›è·¯ç”±
// {
//   path: 'recharge',
//   name: 'MerchantRecharge',
//   component: () => import('@/pages/admin/RechargeManagement.vue'),
//   meta: { title: 'å……å€¼ç®¡ç†' }
// },
// {
//   path: 'withdraw',
//   name: 'MerchantWithdraw',
//   component: () => import('@/pages/admin/WithdrawManagement.vue'),
//   meta: { title: 'æç°ç®¡ç†' }
// }
```

### 3. æ›´æ–°èœå•é…ç½®

æ‰¾åˆ°èœå•é…ç½®æ–‡ä»¶ï¼ˆå¯èƒ½åœ¨ `src/layout/components/Sidebar/` æˆ– `src/config/menu.js`ï¼‰

#### è¶…çº§ç®¡ç†å‘˜èœå•

```javascript
// æ·»åŠ åˆ°è¶…çº§ç®¡ç†å‘˜èœå•
{
  title: 'è´¢åŠ¡ç®¡ç†',
  icon: 'Money',
  children: [
    {
      title: 'å……å€¼ç®¡ç†',
      path: '/super-admin/recharge',
      icon: 'CreditCard'
    },
    {
      title: 'æç°ç®¡ç†',
      path: '/super-admin/withdraw',
      icon: 'Wallet'
    }
  ]
}
```

#### æ°‘å®¿ä¸»èœå•

```javascript
// ä¿®æ”¹æ°‘å®¿ä¸»èœå•
{
  title: 'è´¢åŠ¡ç®¡ç†',
  icon: 'Money',
  children: [
    {
      title: 'æç°ç”³è¯·',      // æ”¹å
      path: '/merchant/withdraw-apply',  // æ–°è·¯å¾„
      icon: 'Wallet'
    }
    // ç§»é™¤å……å€¼ç®¡ç†èœå•é¡¹
  ]
}
```

### 4. æ£€æŸ¥æƒé™å®ˆå«

ç¡®ä¿è·¯ç”±å®ˆå«èƒ½æ­£ç¡®è¯†åˆ«è¶…çº§ç®¡ç†å‘˜å’Œæ°‘å®¿ä¸»ï¼š

```javascript
// router/index.js æˆ– router/permission.js
router.beforeEach((to, from, next) => {
  const userInfo = store.getters.userInfo
  
  if (to.meta.requiresSuperAdmin) {
    // æ£€æŸ¥æ˜¯å¦æ˜¯è¶…çº§ç®¡ç†å‘˜
    if (userInfo.roleCode === 'SUPER_ADMIN' || userInfo.roleId === 3) {
      next()
    } else {
      next({ path: '/403' })
    }
  } else if (to.meta.requiresMerchant) {
    // æ£€æŸ¥æ˜¯å¦æ˜¯æ°‘å®¿ä¸»
    if (userInfo.roleCode === 'MERCHANT_ADMIN' || userInfo.roleId === 2) {
      next()
    } else {
      next({ path: '/403' })
    }
  } else {
    next()
  }
})
```

## ğŸ“ æ–‡ä»¶å¯¹åº”å…³ç³»

### è¶…çº§ç®¡ç†å‘˜

| åŸæ–‡ä»¶ä½ç½® | æ–°æ–‡ä»¶ä½ç½® | å˜åŒ– |
|-----------|-----------|------|
| - | `/src/pages/super-admin/RechargeManagement.vue` | æ–°å»º |
| - | `/src/pages/super-admin/WithdrawManagement.vue` | æ–°å»º |
| - | `/src/api/modules/superAdmin.js` | è¿½åŠ æ¥å£ |

### æ°‘å®¿ä¸»

| åŸæ–‡ä»¶ä½ç½® | æ–°æ–‡ä»¶ä½ç½® | å˜åŒ– |
|-----------|-----------|------|
| `/src/pages/admin/RechargeManagement.vue` | åˆ é™¤ | ç§»é™¤ |
| `/src/pages/admin/WithdrawManagement.vue` | åˆ é™¤ | ç§»é™¤ |
| - | `/src/pages/merchant/WithdrawApply.vue` | æ–°å»º |
| - | `/src/api/modules/merchantWithdraw.js` | æ–°å»º |

## ğŸ§ª æµ‹è¯•æ¸…å•

### è¶…çº§ç®¡ç†å‘˜æµ‹è¯•

ç™»å½•è¶…çº§ç®¡ç†å‘˜è´¦å·åï¼š

- [ ] èƒ½è®¿é—® `/super-admin/recharge` é¡µé¢
- [ ] èƒ½è®¿é—® `/super-admin/withdraw` é¡µé¢
- [ ] å……å€¼ç®¡ç†é¡µé¢èƒ½æŸ¥çœ‹æ‰€æœ‰å•†æˆ·çš„å……å€¼è®°å½•
- [ ] å……å€¼ç®¡ç†é¡µé¢èƒ½å®¡æ ¸å……å€¼ç”³è¯·
- [ ] æç°ç®¡ç†é¡µé¢èƒ½æŸ¥çœ‹æ‰€æœ‰å•†æˆ·çš„æç°è®°å½•
- [ ] æç°ç®¡ç†é¡µé¢èƒ½å®¡æ ¸æç°ç”³è¯·
- [ ] èœå•æ æ˜¾ç¤º"å……å€¼ç®¡ç†"å’Œ"æç°ç®¡ç†"

### æ°‘å®¿ä¸»æµ‹è¯•

ç™»å½•æ°‘å®¿ä¸»è´¦å·åï¼š

- [ ] èƒ½è®¿é—® `/merchant/withdraw-apply` é¡µé¢
- [ ] ä¸èƒ½è®¿é—® `/super-admin/recharge` é¡µé¢ï¼ˆåº”è·³è½¬403ï¼‰
- [ ] ä¸èƒ½è®¿é—® `/super-admin/withdraw` é¡µé¢ï¼ˆåº”è·³è½¬403ï¼‰
- [ ] èƒ½ç”³è¯·æç°
- [ ] èƒ½æŸ¥çœ‹è‡ªå·±çš„æç°è®°å½•
- [ ] åªèƒ½çœ‹åˆ°è‡ªå·±çš„æç°è®°å½•ï¼ˆä¸èƒ½çœ‹åˆ°å…¶ä»–å•†æˆ·çš„ï¼‰
- [ ] èƒ½å–æ¶ˆå¾…å®¡æ ¸çš„æç°ç”³è¯·
- [ ] èœå•æ æ˜¾ç¤º"æç°ç”³è¯·"ï¼Œä¸æ˜¾ç¤º"å……å€¼ç®¡ç†"

### æ•°æ®éš”ç¦»æµ‹è¯•

- [ ] æ°‘å®¿ä¸»Aåªèƒ½çœ‹åˆ°è‡ªå·±çš„æç°è®°å½•
- [ ] æ°‘å®¿ä¸»Båªèƒ½çœ‹åˆ°è‡ªå·±çš„æç°è®°å½•
- [ ] è¶…çº§ç®¡ç†å‘˜èƒ½çœ‹åˆ°æ‰€æœ‰å•†æˆ·çš„å……å€¼å’Œæç°è®°å½•

## ğŸ¯ å¿«é€Ÿå¯åŠ¨æ­¥éª¤

1. **åˆ é™¤æ—§æ–‡ä»¶**
   ```bash
   cd yxly-frontend/src/pages/admin
   rm RechargeManagement.vue WithdrawManagement.vue
   ```

2. **æ›´æ–°è·¯ç”±é…ç½®**
   - æ‰“å¼€ `src/router/index.js`
   - æ·»åŠ è¶…çº§ç®¡ç†å‘˜è·¯ç”±
   - ä¿®æ”¹æ°‘å®¿ä¸»è·¯ç”±
   - ç§»é™¤æ—§çš„å……å€¼/æç°è·¯ç”±

3. **æ›´æ–°èœå•é…ç½®**
   - æ‰¾åˆ°èœå•é…ç½®æ–‡ä»¶
   - ä¸ºè¶…çº§ç®¡ç†å‘˜æ·»åŠ è´¢åŠ¡ç®¡ç†èœå•
   - ä¿®æ”¹æ°‘å®¿ä¸»çš„è´¢åŠ¡ç®¡ç†èœå•

4. **é‡å¯å‰ç«¯æœåŠ¡**
   ```bash
   npm run dev
   ```

5. **æµ‹è¯•åŠŸèƒ½**
   - ç”¨è¶…çº§ç®¡ç†å‘˜è´¦å·ç™»å½•æµ‹è¯•
   - ç”¨æ°‘å®¿ä¸»è´¦å·ç™»å½•æµ‹è¯•

## âš¡ æ³¨æ„äº‹é¡¹

1. **åç«¯å·²å°±ç»ª**
   - æ‰€æœ‰åç«¯æ¥å£å·²åˆ›å»ºå®Œæˆ
   - APIè·¯ç”±å·²é…ç½®
   - æƒé™éªŒè¯å·²å®ç°

2. **å‰ç«¯éœ€å®Œæˆ**
   - è·¯ç”±é…ç½® â³
   - èœå•é…ç½® â³
   - æƒé™å®ˆå« â³
   - åˆ é™¤æ—§æ–‡ä»¶ â³

3. **é‡è¦æé†’**
   - ç¡®ä¿æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åæµ‹è¯•
   - ç¡®ä¿é‡æ–°ç™»å½•è·å–æœ€æ–°çš„ç”¨æˆ·ä¿¡æ¯å’Œæƒé™
   - å¦‚æœèœå•ä¸æ˜¾ç¤ºï¼Œæ£€æŸ¥èœå•æƒé™é…ç½®

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
2. Network é¢æ¿æŸ¥çœ‹APIè°ƒç”¨æ˜¯å¦æ­£ç¡®
3. ç”¨æˆ·ä¿¡æ¯ä¸­çš„ roleCode å’Œ roleId æ˜¯å¦æ­£ç¡®
4. è·¯ç”±é…ç½®ä¸­çš„ meta æƒé™æ˜¯å¦æ­£ç¡®

ç¥æ‚¨è°ƒæ•´é¡ºåˆ©ï¼ğŸ‰
