/* empty css                  *//* empty css                     *//* empty css                *//* empty css                 *//* empty css                    *//* empty css                   *//* empty css                 */import{aB as M,r as f,l as L,z as u,B as n,R as s,J as a,O as p,A as m,u as V}from"./vendor-DSBWSuTS.js";import{d as Z,e as S,l as T,m as j,n as D,p as x,o as J,j as O,h as W,k as G,E as d}from"./elementPlus-fsp5CJhs.js";import{d as H,_ as K,c as Q,b as X}from"./index-rlk3mQiZ.js";const Y=_=>H({url:"/api/v1/merchant/register",method:"post",data:_}),ee={class:"merchant-register-container"},re={class:"register-box"},se=["src"],oe={key:1,class:"upload-placeholder"},te=["src"],ae={key:1,class:"upload-placeholder"},le={class:"back-link"},ie={__name:"MerchantRegister",setup(_){const k=M(),g=f(),c=f(!1),w=f("/api/v1/upload/image"),t=L({username:"",password:"",confirmPassword:"",realName:"",phone:"",idCardFront:"",idCardBack:""}),B=async(o,e,r)=>{if(!e){r(new Error("请输入用户名"));return}if(!/^[a-zA-Z0-9_]+$/.test(e)){r(new Error("用户名只能包含字母、数字和下划线"));return}try{(await X(e)).data?r():r(new Error("用户名已存在"))}catch{r()}},F=async(o,e,r)=>{if(!e){r(new Error("请输入手机号"));return}try{(await Q(e)).data?r():r(new Error("手机号已被注册"))}catch{r()}},z=(o,e,r)=>{if(!e){r(new Error("请输入密码"));return}if(!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/.test(e)){r(new Error("密码至少包含一个字母和一个数字"));return}r()},U=(o,e,r)=>{if(!e){r(new Error("请确认密码"));return}if(e!==t.password){r(new Error("两次输入密码不一致"));return}r()},v=(o,e,r)=>{if(!e){r(new Error("请上传身份证照片"));return}r()},b={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度在3-50个字符",trigger:"blur"},{validator:B,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6-20个字符",trigger:"blur"},{validator:z,trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:U,trigger:"blur"}],realName:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{max:50,message:"姓名长度不能超过50个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"},{validator:F,trigger:"blur"}],idCardFront:[{required:!0,message:"请上传身份证正面",trigger:"change"},{validator:v,trigger:"change"}],idCardBack:[{required:!0,message:"请上传身份证反面",trigger:"change"},{validator:v,trigger:"change"}]},P=(o,e)=>{o.code===200?(t.idCardFront=o.data.url,d.success("身份证正面上传成功")):d.error("上传失败，请重试")},q=(o,e)=>{o.code===200?(t.idCardBack=o.data.url,d.success("身份证反面上传成功")):d.error("上传失败，请重试")},y=o=>{const e=o.type.startsWith("image/"),r=o.size/1024/1024<5;return e?r?!0:(d.error("图片大小不能超过 5MB！"),!1):(d.error("只能上传图片文件！"),!1)},I=async()=>{if(g.value)try{await g.value.validate(),c.value=!0;const o=await Y(t);d.success("注册申请提交成功！请等待平台审核，审核通过后即可登录使用"),setTimeout(()=>{k.push("/login")},3e3)}catch(o){if(o.errors)return;d.error(o.message||"注册失败，请稍后重试")}finally{c.value=!1}};return(o,e)=>{const r=S,l=Z,N=T,h=D,E=j,R=J,$=O,C=W,A=G;return m(),u("div",ee,[n("div",re,[e[15]||(e[15]=n("div",{class:"register-header"},[n("h2",null,"民宿主管理员注册"),n("p",null,"简单几步，开启您的民宿管理之旅")],-1)),s(A,{ref_key:"registerFormRef",ref:g,model:t,rules:b,class:"register-form"},{default:a(()=>[s(l,{prop:"username"},{default:a(()=>[s(r,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=i=>t.username=i),placeholder:"请输入用户名",size:"large","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),s(l,{prop:"password"},{default:a(()=>[s(r,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=i=>t.password=i),type:"password",placeholder:"请输入密码（至少6位，包含字母和数字）",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),s(l,{prop:"confirmPassword"},{default:a(()=>[s(r,{modelValue:t.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=i=>t.confirmPassword=i),type:"password",placeholder:"请再次确认密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),s(l,{prop:"realName"},{default:a(()=>[s(r,{modelValue:t.realName,"onUpdate:modelValue":e[3]||(e[3]=i=>t.realName=i),placeholder:"请输入真实姓名",size:"large","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),s(l,{prop:"phone"},{default:a(()=>[s(r,{modelValue:t.phone,"onUpdate:modelValue":e[4]||(e[4]=i=>t.phone=i),placeholder:"请输入手机号",size:"large","prefix-icon":"Phone"},null,8,["modelValue"])]),_:1}),s(N,null,{default:a(()=>[...e[7]||(e[7]=[p("身份证明",-1)])]),_:1}),s(l,{prop:"idCardFront"},{default:a(()=>[s(E,{class:"id-card-uploader",action:w.value,"show-file-list":!1,"on-success":P,"before-upload":y},{default:a(()=>[t.idCardFront?(m(),u("img",{key:0,src:t.idCardFront,class:"id-card-image"},null,8,se)):(m(),u("div",oe,[s(h,{class:"upload-icon"},{default:a(()=>[s(V(x))]),_:1}),e[8]||(e[8]=n("div",{class:"upload-text"},"上传身份证正面",-1))]))]),_:1},8,["action"])]),_:1}),s(l,{prop:"idCardBack"},{default:a(()=>[s(E,{class:"id-card-uploader",action:w.value,"show-file-list":!1,"on-success":q,"before-upload":y},{default:a(()=>[t.idCardBack?(m(),u("img",{key:0,src:t.idCardBack,class:"id-card-image"},null,8,te)):(m(),u("div",ae,[s(h,{class:"upload-icon"},{default:a(()=>[s(V(x))]),_:1}),e[9]||(e[9]=n("div",{class:"upload-text"},"上传身份证反面",-1))]))]),_:1},8,["action"])]),_:1}),s(R,{title:"温馨提示",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:a(()=>[...e[10]||(e[10]=[p(" 提交注册申请后，需要等待平台审核通过才能使用。请确保信息真实有效。 ",-1)])]),_:1}),s(l,null,{default:a(()=>[s($,{type:"primary",size:"large",style:{width:"100%"},loading:c.value,onClick:I},{default:a(()=>[...e[11]||(e[11]=[p(" 提交注册申请 ",-1)])]),_:1},8,["loading"])]),_:1}),s(l,null,{default:a(()=>[n("div",le,[s(C,{type:"primary",onClick:e[5]||(e[5]=i=>o.$router.push("/register"))},{default:a(()=>[...e[12]||(e[12]=[p(" 返回普通用户注册 ",-1)])]),_:1}),e[14]||(e[14]=n("span",{style:{margin:"0 10px"}},"|",-1)),s(C,{type:"primary",onClick:e[6]||(e[6]=i=>o.$router.push("/login"))},{default:a(()=>[...e[13]||(e[13]=[p(" 已有账号，去登录 ",-1)])]),_:1})])]),_:1})]),_:1},8,["model"])])])}}},ve=K(ie,[["__scopeId","data-v-7e7ca5ac"]]);export{ve as default};
