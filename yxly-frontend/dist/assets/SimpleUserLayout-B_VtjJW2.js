/* empty css                  *//* empty css                        *//* empty css                     *//* empty css                         *//* empty css                  */import{r as R,j as S,U as $,al as w,z as g,B as l,C as h,E as z,A as p,R as e,J as t,O as a,aB as D,c as k,I as M,L as y,P as x,u as d}from"./vendor-DSBWSuTS.js";import{q as V,r as H,n as j,s as q,t as J,u as K,v as O,w as P,x as Y,y as F,z as G,A as Q,E as I,a as W}from"./elementPlus-fsp5CJhs.js";import{f as X,g as Z,h as ee,_ as b,u as oe}from"./index-rlk3mQiZ.js";function E(){try{X(),Z(),ee();const _=[];for(let s=0;s<localStorage.length;s++){const n=localStorage.key(s);n&&(n.includes("token")||n.includes("auth")||n.includes("pinia"))&&_.push(n)}_.forEach(s=>localStorage.removeItem(s));const u=[];for(let s=0;s<sessionStorage.length;s++){const n=sessionStorage.key(s);n&&(n.includes("token")||n.includes("auth")||n.includes("user"))&&u.push(n)}return u.forEach(s=>sessionStorage.removeItem(s)),console.log("已清除所有无效的认证数据"),!0}catch(_){return console.error("清除认证数据时出错:",_),!1}}const se={class:"container yx-header__container"},te={class:"yx-header__nav"},ne={class:"yx-header__actions"},re={__name:"Header",setup(_){const u=R(!1),s=()=>{u.value=window.scrollY>8};return S(()=>window.addEventListener("scroll",s,{passive:!0})),$(()=>window.removeEventListener("scroll",s)),(n,r)=>{const v=w("router-link");return p(),g("header",{class:z(["yx-header",{"yx-header--scrolled":u.value}])},[l("div",se,[r[6]||(r[6]=l("div",{class:"yx-header__brand"},[l("span",{class:"yx-header__title brand-title"},"悦鑫乐怡民宿")],-1)),l("nav",te,[h(n.$slots,"nav",{},()=>[r[0]||(r[0]=l("a",{href:"#home",class:"yx-header__link"},"首页",-1)),r[1]||(r[1]=l("a",{href:"#explore",class:"yx-header__link"},"探索",-1)),r[2]||(r[2]=l("a",{href:"#map",class:"yx-header__link"},"地图",-1)),r[3]||(r[3]=l("a",{href:"#contact",class:"yx-header__link"},"联系",-1))],!0)]),l("div",ne,[h(n.$slots,"actions",{},()=>[e(v,{to:"/login",class:"login-link"},{default:t(()=>[...r[4]||(r[4]=[a(" 登录 ",-1)])]),_:1}),e(v,{to:"/register",class:"register-link"},{default:t(()=>[...r[5]||(r[5]=[a(" 注册 ",-1)])]),_:1})],!0)])])],2)}}},ae=b(re,[["__scopeId","data-v-a2e0cff4"]]),le={class:"simple-user-layout"},ue={key:0,class:"nav-auth"},ie={class:"user-dropdown-trigger"},de={style:{"min-height":"calc(100vh - 140px)"}},ce={__name:"SimpleUserLayout",setup(_){const u=D(),s=oe(),n=k(()=>s.isAuthenticated&&s.userInfo),r=k(()=>{var i,o;return((i=s.userInfo)==null?void 0:i.realName)||((o=s.userInfo)==null?void 0:o.username)||"用户"}),v=k(()=>{var i;return((i=s.userInfo)==null?void 0:i.avatar)||""}),A=async i=>{switch(i){case"profile":u.push("/user-center/profile");break;case"wallet":u.push("/user-center/wallet");break;case"orders":u.push("/user-center/orders");break;case"favorites":u.push("/user-center/favorites");break;case"settings":u.push("/user-center/settings");break;case"logout":await B();break}},B=async()=>{try{await W.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await s.logout(),I.success("退出登录成功"),u.push("/home")}catch(i){i!=="cancel"&&(console.error("退出登录失败:",i),s.clearUserInfo(),u.push("/home"))}},L=()=>{console.log("手动清除无效登录状态"),s.clearUserInfo(),E(),I.success("已清除无效登录状态"),setTimeout(()=>{window.location.reload()},500)};return S(()=>{s.token&&!s.userInfo&&(console.log("检测到无效token，清除登录状态"),s.clearUserInfo(),E(),setTimeout(()=>{window.location.reload()},100))}),(i,o)=>{const f=w("router-link"),T=H,c=j,m=K,U=J,C=V,N=w("router-view");return p(),g("div",le,[e(ae,null,{nav:t(()=>[e(f,{to:"/home",class:"yx-header__link"},{default:t(()=>[...o[0]||(o[0]=[a("首页",-1)])]),_:1}),e(f,{to:"/rooms",class:"yx-header__link"},{default:t(()=>[...o[1]||(o[1]=[a("房间预订",-1)])]),_:1}),e(f,{to:"/about",class:"yx-header__link"},{default:t(()=>[...o[2]||(o[2]=[a("关于我们",-1)])]),_:1}),e(f,{to:"/contact",class:"yx-header__link"},{default:t(()=>[...o[3]||(o[3]=[a("联系我们",-1)])]),_:1}),n.value?y("",!0):(p(),g("span",ue,[e(f,{to:"/login",class:"login-link"},{default:t(()=>[...o[4]||(o[4]=[a("登录",-1)])]),_:1}),e(f,{to:"/register",class:"register-link"},{default:t(()=>[...o[5]||(o[5]=[a("注册",-1)])]),_:1})]))]),actions:t(()=>[n.value?(p(),M(C,{key:0,onCommand:A,trigger:"click"},{dropdown:t(()=>[e(U,null,{default:t(()=>[e(m,{command:"profile"},{default:t(()=>[e(c,null,{default:t(()=>[e(d(O))]),_:1}),o[6]||(o[6]=a(" 个人中心 ",-1))]),_:1}),e(m,{command:"wallet"},{default:t(()=>[e(c,null,{default:t(()=>[e(d(P))]),_:1}),o[7]||(o[7]=a(" 我的钱包 ",-1))]),_:1}),e(m,{command:"orders"},{default:t(()=>[e(c,null,{default:t(()=>[e(d(Y))]),_:1}),o[8]||(o[8]=a(" 预订信息 ",-1))]),_:1}),e(m,{command:"favorites"},{default:t(()=>[e(c,null,{default:t(()=>[e(d(F))]),_:1}),o[9]||(o[9]=a(" 我的收藏 ",-1))]),_:1}),e(m,{command:"settings",divided:""},{default:t(()=>[e(c,null,{default:t(()=>[e(d(G))]),_:1}),o[10]||(o[10]=a(" 账户设置 ",-1))]),_:1}),e(m,{command:"logout",divided:""},{default:t(()=>[e(c,null,{default:t(()=>[e(d(Q))]),_:1}),o[11]||(o[11]=a(" 退出登录 ",-1))]),_:1})]),_:1})]),default:t(()=>[l("span",ie,[e(T,{size:28,src:v.value},{default:t(()=>[a(x(r.value.charAt(0)),1)]),_:1},8,["src"]),l("span",null,"欢迎，"+x(r.value),1),e(c,null,{default:t(()=>[e(d(q))]),_:1})])]),_:1})):y("",!0),d(s).token&&!d(s).userInfo?(p(),g("button",{key:1,onClick:L,class:"logout-badge",title:"检测到无效登录状态，点击清除"}," 清除无效状态 ")):y("",!0)]),_:1}),l("main",de,[e(N)]),o[12]||(o[12]=l("footer",{class:"simple-footer"},[l("p",null,"© 2025 悦鑫乐怡民宿管理系统. 由LuoRui开发.")],-1))])}}},we=b(ce,[["__scopeId","data-v-b1eccc33"]]);export{we as default};
