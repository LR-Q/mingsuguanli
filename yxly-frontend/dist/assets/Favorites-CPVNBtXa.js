/* empty css                  *//* empty css                 *//* empty css               *//* empty css                        *//* empty css                 *//* empty css                */import{aB as V,r as h,c as L,j as S,z as p,R as o,J as r,B as t,u as y,P as l,I as E,A as c,Q as B,a6 as $,O as f}from"./vendor-DSBWSuTS.js";import{n as J,y as O,a0 as P,U,T as j,j as D,J as K,_ as Q,R as q,e as G,O as H,E as g,a as W}from"./elementPlus-fsp5CJhs.js";import{g as X,r as Y}from"./favorite-BYD8vYC-.js";import{_ as Z}from"./index-rlk3mQiZ.js";const ee={class:"favorites-page"},se={class:"favorites-stats"},te={class:"stat-item"},ae={class:"stat-icon"},oe={class:"stat-content"},re={class:"stat-number"},ne={class:"card-header"},ie={class:"header-actions"},le={key:0,class:"room-grid"},ce={class:"room-image"},de={class:"image-slot"},ue={class:"room-actions"},_e={class:"room-info"},pe={class:"room-header"},fe={class:"room-type"},me={class:"room-description"},ve={class:"room-features"},ye={class:"room-footer"},ge={class:"room-price"},he={class:"price"},ke={class:"room-buttons"},we={__name:"Favorites",setup(xe){const k=V(),m=h(""),w=h(!1),d=h([]),x=L(()=>{if(!m.value)return d.value;const s=m.value.toLowerCase();return d.value.filter(e=>e.name.toLowerCase().includes(s)||e.type.toLowerCase().includes(s))}),N=async()=>{try{w.value=!0;const s=await X();s.data&&Array.isArray(s.data)&&(d.value=s.data.map(e=>{let i="";if(e.images)try{const n=typeof e.images=="string"?JSON.parse(e.images):e.images;i=Array.isArray(n)&&n.length>0?n[0]:""}catch(n){console.error("解析图片失败:",n)}let u=[];if(e.facilities)try{u=typeof e.facilities=="string"?JSON.parse(e.facilities):e.facilities}catch(n){console.error("解析设施失败:",n),u=[]}return{id:e.room_id||e.roomId||e.id,name:e.room_type_name||e.roomTypeName||e.room_number||e.roomNumber||"房间",type:e.room_type_name||e.roomTypeName||"标准房型",description:e.description||"舒适温馨的房间",image:i,price:e.current_price||e.currentPrice||e.base_price||e.basePrice||0,features:u,status:e.status||1,favoriteTime:e.create_time||e.createTime||e.favoriteTime}}))}catch(s){console.error("加载收藏列表失败:",s),g.error("加载收藏列表失败")}finally{w.value=!1}},R=async s=>{try{await W.confirm(`确定要取消收藏"${s.name}"吗？`,"取消收藏",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Y(s.id);const e=d.value.findIndex(i=>i.id===s.id);e>-1&&d.value.splice(e,1),g.success("已取消收藏")}catch(e){e!=="cancel"&&(console.error("取消收藏失败:",e),g.error("取消收藏失败"))}},z=s=>{k.push(`/rooms/${s.id}`)},F=s=>{if(s.status!==1){const e=b(s.status);g.warning(`该房间当前${e}，无法预订`);return}k.push(`/rooms/${s.id}/book`)},b=s=>({1:"可用",2:"已被预订",3:"维修中",4:"清洁中",5:"已停用"})[s]||"未知状态",I=s=>({1:"success",2:"warning",3:"danger",4:"info",5:"info"})[s]||"info",T=s=>s===1;return S(()=>{N()}),(s,e)=>{const i=J,u=P,n=G,M=U,v=D,C=Q,A=q;return c(),p("div",ee,[o(u,{class:"stats-card",shadow:"never"},{default:r(()=>[t("div",se,[t("div",te,[t("div",ae,[o(i,null,{default:r(()=>[o(y(O))]),_:1})]),t("div",oe,[e[2]||(e[2]=t("h3",null,"收藏房间",-1)),t("p",re,l(d.value.length),1)])])])]),_:1}),o(u,{class:"favorites-list-card",shadow:"never"},{header:r(()=>[t("div",ne,[e[3]||(e[3]=t("h3",null,"我的收藏",-1)),t("div",ie,[o(n,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),placeholder:"搜索房间名称",style:{width:"200px"},clearable:""},{prefix:r(()=>[o(i,null,{default:r(()=>[o(y(H))]),_:1})]),_:1},8,["modelValue"])])])]),default:r(()=>[x.value.length>0?(c(),p("div",le,[(c(!0),p(B,null,$(x.value,a=>(c(),p("div",{key:a.id,class:"room-card"},[t("div",ce,[o(M,{src:a.image,fit:"cover",style:{width:"100%",height:"200px"}},{error:r(()=>[t("div",de,[o(i,null,{default:r(()=>[o(y(j))]),_:1})])]),_:1},8,["src"]),t("div",ue,[o(v,{type:"danger",icon:y(K),circle:"",size:"small",onClick:_=>R(a)},null,8,["icon","onClick"])])]),t("div",_e,[t("div",pe,[t("h4",null,l(a.name),1),o(C,{type:I(a.status),size:"small"},{default:r(()=>[f(l(b(a.status)),1)]),_:2},1032,["type"])]),t("p",fe,l(a.type),1),t("p",me,l(a.description),1),t("div",ve,[(c(!0),p(B,null,$(a.features,_=>(c(),E(C,{key:_,size:"small",type:"info"},{default:r(()=>[f(l(_),1)]),_:2},1024))),128))]),t("div",ye,[t("div",ge,[t("span",he,"¥"+l(a.price),1),e[4]||(e[4]=t("span",{class:"unit"},"/晚",-1))]),t("div",ke,[o(v,{size:"small",onClick:_=>z(a)},{default:r(()=>[...e[5]||(e[5]=[f(" 查看详情 ",-1)])]),_:1},8,["onClick"]),o(v,{type:"primary",size:"small",onClick:_=>F(a),disabled:!T(a.status)},{default:r(()=>[f(l(T(a.status)?"立即预订":"暂不可订"),1)]),_:2},1032,["onClick","disabled"])])])])]))),128))])):(c(),E(A,{key:1,description:"暂无收藏的房间","image-size":200},{default:r(()=>[o(v,{type:"primary",onClick:e[1]||(e[1]=a=>s.$router.push("/rooms"))},{default:r(()=>[...e[6]||(e[6]=[f(" 去看看房间 ",-1)])]),_:1})]),_:1}))]),_:1})])}}},Ie=Z(we,[["__scopeId","data-v-56e00476"]]);export{Ie as default};
