/* empty css                  *//* empty css                   *//* empty css                  *//* empty css                   *//* empty css                             *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                *//* empty css                     *//* empty css                        */import{d as I,_ as ee}from"./index-rlk3mQiZ.js";import{k as te,d as ae,a8 as le,L as oe,K as ne,e as re,j as se,a0 as ue,a5 as ie,a6 as de,_ as pe,ak as me,a7 as ce,ab as _e,ac as fe,S as we,E as y,a as he}from"./elementPlus-fsp5CJhs.js";import{r as w,l as W,j as ve,z as A,B as d,R as e,J as a,O as n,K as ge,A as E,I as L,P as s,L as N}from"./vendor-DSBWSuTS.js";const ye=h=>I({url:"/api/v1/merchant/withdraw/my-records",method:"get",params:h}),be=h=>I({url:"/api/v1/merchant/withdraw/apply",method:"post",data:h}),Ve=h=>I({url:`/api/v1/merchant/withdraw/cancel/${h}`,method:"post"}),xe={class:"withdraw-apply"},Ee={class:"card-header"},Ce={class:"amount-text"},ke={class:"pagination-wrapper"},ze={key:0,class:"detail-content"},Ie={class:"amount-text"},Re={__name:"WithdrawApply",setup(h){const C=w(!1),k=w(!1),R=w([]),z=w(!1),r=w(null),g=w(null),b=w(null),u=W({amount:null,withdrawMethod:"",accountInfo:"",userRemark:""}),q={amount:[{required:!0,message:"请输入提现金额",trigger:"blur"},{validator:(o,t,p)=>{t<=0?p(new Error("提现金额必须大于0")):t>1e4?p(new Error("单次提现金额不能超过10000元")):p()},trigger:"blur"}],withdrawMethod:[{required:!0,message:"请选择提现方式",trigger:"change"}],accountInfo:[{required:!0,message:"请输入收款账户信息",trigger:"blur"}]},i=W({current:1,size:10,total:0}),v=async()=>{C.value=!0;try{const o={current:i.current,size:i.size,status:b.value!==null?b.value:void 0},{data:t}=await ye(o);R.value=t.records,i.total=t.total}catch(o){console.error("加载提现记录失败:",o),y.error("加载提现记录失败")}finally{C.value=!1}},j=async()=>{g.value&&await g.value.validate(async o=>{var t,p;if(o){k.value=!0;try{await be(u),y.success("提现申请提交成功，请等待审核"),D(),v()}catch(m){console.error("提现申请失败:",m),y.error(((p=(t=m.response)==null?void 0:t.data)==null?void 0:p.message)||"提现申请失败")}finally{k.value=!1}}})},D=()=>{g.value&&g.value.resetFields(),Object.assign(u,{amount:null,withdrawMethod:"",accountInfo:"",userRemark:""})},O=o=>{r.value=o,z.value=!0},P=o=>{he.confirm("确定要取消该提现申请吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await Ve(o.id),y.success("提现申请已取消"),v()}catch(t){console.error("取消提现失败:",t),y.error("取消提现失败")}}).catch(()=>{})},$=o=>{i.size=o,i.current=1,v()},K=o=>{i.current=o,v()},T=o=>parseFloat(o).toFixed(2),V=o=>o?new Date(o).toLocaleString("zh-CN"):"-",M=o=>{switch(o){case 0:return"warning";case 1:return"success";case 2:return"danger";default:return"info"}};return ve(()=>{v()}),(o,t)=>{const p=le,m=ae,f=ne,F=oe,B=re,x=se,J=te,S=ue,c=de,U=pe,G=ie,H=ce,_=fe,Q=_e,X=we,Y=me;return E(),A("div",xe,[t[15]||(t[15]=d("div",{class:"page-header"},[d("h2",null,"提现申请"),d("p",null,"申请提现并查看提现记录")],-1)),e(S,{class:"apply-card",shadow:"never"},{header:a(()=>[...t[8]||(t[8]=[d("div",{class:"card-header"},[d("span",null,"申请提现")],-1)])]),default:a(()=>[e(J,{model:u,rules:q,ref_key:"applyFormRef",ref:g,"label-width":"100px"},{default:a(()=>[e(m,{label:"提现金额",prop:"amount"},{default:a(()=>[e(p,{modelValue:u.amount,"onUpdate:modelValue":t[0]||(t[0]=l=>u.amount=l),min:.01,max:1e4,precision:2,step:100,placeholder:"请输入提现金额"},null,8,["modelValue"]),t[9]||(t[9]=d("span",{class:"hint-text"},"（最小0.01元，最大10000元）",-1))]),_:1}),e(m,{label:"提现方式",prop:"withdrawMethod"},{default:a(()=>[e(F,{modelValue:u.withdrawMethod,"onUpdate:modelValue":t[1]||(t[1]=l=>u.withdrawMethod=l),placeholder:"请选择提现方式",style:{width:"200px"}},{default:a(()=>[e(f,{label:"支付宝",value:"支付宝"}),e(f,{label:"微信",value:"微信"}),e(f,{label:"银行卡",value:"银行卡"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"收款账户",prop:"accountInfo"},{default:a(()=>[e(B,{modelValue:u.accountInfo,"onUpdate:modelValue":t[2]||(t[2]=l=>u.accountInfo=l),placeholder:"请输入收款账户信息",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(m,{label:"备注说明"},{default:a(()=>[e(B,{modelValue:u.userRemark,"onUpdate:modelValue":t[3]||(t[3]=l=>u.userRemark=l),type:"textarea",rows:3,placeholder:"请输入备注说明（可选）",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(m,null,{default:a(()=>[e(x,{type:"primary",onClick:j,loading:k.value},{default:a(()=>[...t[10]||(t[10]=[n(" 提交申请 ",-1)])]),_:1},8,["loading"]),e(x,{onClick:D},{default:a(()=>[...t[11]||(t[11]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(S,{class:"record-card",shadow:"never"},{header:a(()=>[d("div",Ee,[t[12]||(t[12]=d("span",null,"我的提现记录",-1)),e(F,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=l=>b.value=l),placeholder:"筛选状态",clearable:"",style:{width:"150px"},onChange:v},{default:a(()=>[e(f,{label:"全部",value:null}),e(f,{label:"待审核",value:0}),e(f,{label:"审核通过",value:1}),e(f,{label:"审核拒绝",value:2})]),_:1},8,["modelValue"])])]),default:a(()=>[ge((E(),L(G,{data:R.value,stripe:"",style:{width:"100%"}},{default:a(()=>[e(c,{prop:"id",label:"ID",width:"80"}),e(c,{label:"提现金额",width:"120"},{default:a(({row:l})=>[d("span",Ce,"¥"+s(T(l.amount)),1)]),_:1}),e(c,{prop:"withdrawMethod",label:"提现方式",width:"100"}),e(c,{prop:"accountInfo",label:"收款账户","min-width":"150","show-overflow-tooltip":""}),e(c,{label:"状态",width:"120"},{default:a(({row:l})=>[e(U,{type:M(l.status),size:"small"},{default:a(()=>[n(s(l.statusDesc),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"申请时间",width:"180"},{default:a(({row:l})=>[n(s(V(l.applyTime)),1)]),_:1}),e(c,{label:"审核时间",width:"180"},{default:a(({row:l})=>[n(s(l.auditTime?V(l.auditTime):"-"),1)]),_:1}),e(c,{label:"操作",width:"180",fixed:"right"},{default:a(({row:l})=>[e(x,{type:"info",size:"small",onClick:Z=>O(l)},{default:a(()=>[...t[13]||(t[13]=[n(" 查看详情 ",-1)])]),_:1},8,["onClick"]),l.status===0?(E(),L(x,{key:0,type:"danger",size:"small",onClick:Z=>P(l)},{default:a(()=>[...t[14]||(t[14]=[n(" 取消申请 ",-1)])]),_:1},8,["onClick"])):N("",!0)]),_:1})]),_:1},8,["data"])),[[Y,C.value]]),d("div",ke,[e(H,{"current-page":i.current,"onUpdate:currentPage":t[5]||(t[5]=l=>i.current=l),"page-size":i.size,"onUpdate:pageSize":t[6]||(t[6]=l=>i.size=l),"page-sizes":[10,20,50],total:i.total,layout:"total, sizes, prev, pager, next",onSizeChange:$,onCurrentChange:K},null,8,["current-page","page-size","total"])])]),_:1}),e(X,{modelValue:z.value,"onUpdate:modelValue":t[7]||(t[7]=l=>z.value=l),title:"提现记录详情",width:"600px"},{default:a(()=>[r.value?(E(),A("div",ze,[e(Q,{column:2,border:""},{default:a(()=>[e(_,{label:"提现金额"},{default:a(()=>[d("span",Ie,"¥"+s(T(r.value.amount)),1)]),_:1}),e(_,{label:"提现方式"},{default:a(()=>[n(s(r.value.withdrawMethod),1)]),_:1}),e(_,{label:"收款账户",span:2},{default:a(()=>[n(s(r.value.accountInfo),1)]),_:1}),e(_,{label:"状态"},{default:a(()=>[e(U,{type:M(r.value.status)},{default:a(()=>[n(s(r.value.statusDesc),1)]),_:1},8,["type"])]),_:1}),e(_,{label:"申请时间"},{default:a(()=>[n(s(V(r.value.applyTime)),1)]),_:1}),e(_,{label:"审核时间",span:2},{default:a(()=>[n(s(r.value.auditTime?V(r.value.auditTime):"-"),1)]),_:1}),e(_,{label:"用户备注",span:2},{default:a(()=>[n(s(r.value.userRemark||"无"),1)]),_:1}),e(_,{label:"审核备注",span:2},{default:a(()=>[n(s(r.value.auditRemark||"无"),1)]),_:1})]),_:1})])):N("",!0)]),_:1},8,["modelValue"])])}}},He=ee(Re,[["__scopeId","data-v-4762aa8f"]]);export{He as default};
