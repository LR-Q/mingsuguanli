/* empty css                  *//* empty css                     *//* empty css                   *//* empty css                *//* empty css                 */import{aB as h,r as g,l as P,z as x,B as i,R as o,J as l,O as d,A as z}from"./vendor-DSBWSuTS.js";import{_ as U,u as N,r as R,c as $,a as B,b as C}from"./index-rlk3mQiZ.js";import{d as k,e as A,j as F,h as I,l as T,k as q,E as f}from"./elementPlus-fsp5CJhs.js";const b={class:"register-container"},L={class:"register-box"},Z={class:"login-link"},M={__name:"Register",setup(S){const w=h(),u=N(),m=g(),p=g(!1);g(0);const s=P({username:"",email:"",phone:"",realName:"",password:"",confirmPassword:""}),_={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度在3-50个字符",trigger:"blur"},{validator:async(a,e,r)=>{if(!e){r(new Error("请输入用户名"));return}if(!/^[a-zA-Z0-9_]+$/.test(e)){r(new Error("用户名只能包含字母、数字和下划线"));return}try{(await C(e)).data?r():r(new Error("用户名已存在"))}catch{r()}},trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"},{validator:async(a,e,r)=>{if(!e){r();return}try{(await B(e)).data?r():r(new Error("邮箱已被注册"))}catch{r()}},trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"},{validator:async(a,e,r)=>{if(!e){r();return}try{(await $(e)).data?r():r(new Error("手机号已被注册"))}catch{r()}},trigger:"blur"}],realName:[{max:50,message:"姓名长度不能超过50个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6-20个字符",trigger:"blur"},{validator:(a,e,r)=>{if(!e){r(new Error("请输入密码"));return}if(!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/.test(e)){r(new Error("密码至少包含一个字母和一个数字"));return}r()},trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(a,e,r)=>{if(!e){r(new Error("请确认密码"));return}if(e!==s.password){r(new Error("两次输入密码不一致"));return}r()},trigger:"blur"}]},E=async()=>{if(m.value)try{await m.value.validate(),p.value=!0;const a=await R({username:s.username,email:s.email||void 0,phone:s.phone,realName:s.realName||void 0,password:s.password,confirmPassword:s.confirmPassword});a.data?(u.setToken(a.data.accessToken),u.setRefreshToken(a.data.refreshToken),u.setUserInfo(a.data.userInfo),f.success("注册成功，欢迎使用悦鑫乐怡民宿管理系统！"),w.push("/")):(f.success("注册成功，请登录"),w.push("/login"))}catch(a){f.error(a.message||"注册失败")}finally{p.value=!1}};return(a,e)=>{const r=A,t=k,v=F,V=I,y=T,c=q;return z(),x("div",b,[i("div",L,[e[13]||(e[13]=i("div",{class:"register-header"},[i("h2",null,"用户注册"),i("p",null,"创建您的账号")],-1)),o(c,{ref_key:"registerFormRef",ref:m,model:s,rules:_,class:"register-form"},{default:l(()=>[o(t,{prop:"username"},{default:l(()=>[o(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=n=>s.username=n),placeholder:"请输入用户名",size:"large","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),o(t,{prop:"email"},{default:l(()=>[o(r,{modelValue:s.email,"onUpdate:modelValue":e[1]||(e[1]=n=>s.email=n),placeholder:"请输入邮箱",size:"large","prefix-icon":"Message"},null,8,["modelValue"])]),_:1}),o(t,{prop:"phone"},{default:l(()=>[o(r,{modelValue:s.phone,"onUpdate:modelValue":e[2]||(e[2]=n=>s.phone=n),placeholder:"请输入手机号",size:"large","prefix-icon":"Phone"},null,8,["modelValue"])]),_:1}),o(t,{prop:"realName"},{default:l(()=>[o(r,{modelValue:s.realName,"onUpdate:modelValue":e[3]||(e[3]=n=>s.realName=n),placeholder:"请输入真实姓名（可选）",size:"large","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),o(t,{prop:"password"},{default:l(()=>[o(r,{modelValue:s.password,"onUpdate:modelValue":e[4]||(e[4]=n=>s.password=n),type:"password",placeholder:"请输入密码（至少6位，包含字母数字）",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o(t,{prop:"confirmPassword"},{default:l(()=>[o(r,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=n=>s.confirmPassword=n),type:"password",placeholder:"请确认密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o(t,null,{default:l(()=>[o(v,{type:"primary",size:"large",style:{width:"100%"},loading:p.value,onClick:E},{default:l(()=>[...e[8]||(e[8]=[d(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1}),o(t,null,{default:l(()=>[i("div",Z,[e[10]||(e[10]=d(" 已有账号？ ",-1)),o(V,{type:"primary",onClick:e[6]||(e[6]=n=>a.$router.push("/login"))},{default:l(()=>[...e[9]||(e[9]=[d(" 立即登录 ",-1)])]),_:1})])]),_:1}),o(y,null,{default:l(()=>[...e[11]||(e[11]=[d("或",-1)])]),_:1}),o(t,null,{default:l(()=>[o(v,{type:"success",size:"large",style:{width:"100%"},plain:"",onClick:e[7]||(e[7]=n=>a.$router.push("/merchant-register"))},{default:l(()=>[...e[12]||(e[12]=[d(" 我是民宿主，注册管理员账号 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])])}}},se=U(M,[["__scopeId","data-v-f50c0d45"]]);export{se as default};
