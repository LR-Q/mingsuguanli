# 快速启用多卧室床型配置功能

## 第一步：执行数据库脚本

```bash
# 1. 打开MySQL命令行或数据库管理工具

# 2. 选择数据库
USE yxly_db;

# 3. 执行以下SQL
ALTER TABLE room_info ADD COLUMN bedroom_config JSON COMMENT '卧室配置(JSON格式)' AFTER bed_type;

# 4. 为现有数据添加默认配置
UPDATE room_info 
SET bedroom_config = JSON_OBJECT(
    'bedrooms', JSON_ARRAY(
        JSON_OBJECT(
            'name', '卧室',
            'bedType', COALESCE(bed_type, '大床'),
            'bedCount', 1
        )
    )
)
WHERE bedroom_config IS NULL AND deleted = 0;

# 5. 验证
SELECT id, room_number, bed_type, bedroom_config FROM room_info LIMIT 5;
```

## 第二步：重启服务

```bash
# 停止当前运行的后端服务（如果正在运行）
# 按 Ctrl+C 停止

# 重启后端
cd e:\CursorProject\LRminsu\yxly-backend
mvn spring-boot:run

# 等待后端启动完成（看到 "Started Application"）

# 重启前端（如果前端正在运行，按Ctrl+C停止，然后）
cd e:\CursorProject\LRminsu\yxly-admin-frontend
npm run dev
```

## 第三步：测试功能

1. **登录管理员后台** (http://localhost:3001)
2. **进入"房间管理"**
3. **找到一个"两房一厅"房型的房间，点击"编辑"**
4. **查看效果**：
   - 应该看到"卧室配置"区域
   - 显示主卧和次卧两个配置项
   - 每个卧室可以单独设置床型

## 预期效果

### 编辑两房一厅时应该看到：

```
房型: [两房一厅 ▼]

卧室配置 *
─────────────────────────────────────
主卧      [大床 ▼]      [1] 张
─────────────────────────────────────
次卧      [双床 ▼]      [2] 张   [🗑]
─────────────────────────────────────
[➕ 添加卧室]

最大入住人数: [4]
房间状态: [可用 ▼]
```

### 编辑单房/标准间时应该看到：

```
房型: [标准间 ▼]

床型: [大床 ▼]
最大入住人数: [2]
房间状态: [可用 ▼]
```

## 快速验证清单

- [ ] 数据库字段`bedroom_config`已添加
- [ ] 后端服务已重启
- [ ] 前端服务已重启
- [ ] 编辑两房一厅可以看到卧室配置区域
- [ ] 可以修改每个卧室的床型
- [ ] 可以添加/删除卧室
- [ ] 保存后数据正确存储

## 如果遇到问题

### 问题1：前端页面报错或显示异常
**解决**：清除浏览器缓存，按`Ctrl+F5`强制刷新

### 问题2：后端启动失败
**解决**：
1. 检查数据库字段是否添加成功
2. 查看后端日志错误信息
3. 确认`RoomInfo.java`文件已保存

### 问题3：编辑页面还是老样式
**解决**：
1. 确认前端代码已保存
2. 重启前端服务：`npm run dev`
3. 清除浏览器缓存

## 完成！

现在您的系统已支持多卧室床型详细配置功能。管理员可以为每个卧室单独设置床型，顾客也能清楚地看到各个房间的具体配置。
