-- 创建预订订单表
CREATE TABLE IF NOT EXISTS `booking_order` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '订单ID',
    `order_no` VARCHAR(32) NOT NULL COMMENT '订单号',
    `customer_id` BIGINT NOT NULL COMMENT '客户ID',
    `room_id` BIGINT NOT NULL COMMENT '房间ID',
    `check_in_date` DATE NOT NULL COMMENT '入住日期',
    `check_out_date` DATE NOT NULL COMMENT '退房日期',
    `nights` INT NOT NULL COMMENT '入住天数',
    `guests_count` INT NOT NULL COMMENT '入住人数',
    `room_price` DECIMAL(10,2) NOT NULL COMMENT '房间单价',
    `total_amount` DECIMAL(10,2) NOT NULL COMMENT '订单总金额',
    `paid_amount` DECIMAL(10,2) DEFAULT 0.00 COMMENT '已付金额',
    `booking_status` TINYINT NOT NULL DEFAULT 1 COMMENT '预订状态(1:待确认 2:已确认 3:已入住 4:已退房 5:已取消)',
    `payment_status` TINYINT NOT NULL DEFAULT 0 COMMENT '支付状态(0:未支付 1:已支付 2:部分支付 3:已退款)',
    `booking_source` VARCHAR(20) DEFAULT '网站' COMMENT '预订来源',
    `special_requests` TEXT COMMENT '特殊要求',
    `contact_phone` VARCHAR(20) COMMENT '联系电话',
    `contact_name` VARCHAR(50) COMMENT '联系人',
    `check_in_time` DATETIME COMMENT '实际入住时间',
    `check_out_time` DATETIME COMMENT '实际退房时间',
    `operator_id` BIGINT COMMENT '操作员ID',
    `cancel_reason` VARCHAR(200) COMMENT '取消原因',
    `cancel_time` DATETIME COMMENT '取消时间',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记：0-未删除，1-已删除',
    PRIMARY KEY (`id`),
    UNIQUE KEY `uk_order_no` (`order_no`),
    INDEX `idx_customer_id` (`customer_id`),
    INDEX `idx_room_id` (`room_id`),
    INDEX `idx_check_in_date` (`check_in_date`),
    INDEX `idx_check_out_date` (`check_out_date`),
    INDEX `idx_booking_status` (`booking_status`),
    INDEX `idx_payment_status` (`payment_status`),
    INDEX `idx_create_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='预订订单表';
